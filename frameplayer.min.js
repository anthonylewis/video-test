var FramePlayer=function(e,t){this.divCont=document.getElementById(e),this.elem=e,this.jsonVideoSrc=this.divCont.getAttribute("data-vidsrc"),this.rate=20,this.controls=!0,this.paused=!1,this.width="480px",this.height="320px",this.radius=null,this.setOptions(t),this.initializeRequestAnimationFrame()};FramePlayer.prototype.setOptions=function(e){if("rate"in e&&(this.rate=e.rate),"controls"in e&&(this.controls=e.controls),"autoplay"in e&&(e.autoplay||(this.paused=!0)),"width"in e&&(this.width=e.width),"height"in e&&(this.height=e.height),"radius"in e){var t=document.createElement("style");t.setAttribute("id","style-"+this.elem),t.innerHTML="#"+this.elem+", .frames-"+this.elem+"{ border-radius: "+e.radius+"; overflow: hidden;}",document.head.appendChild(t)}this.divCont.style.width=this.width,this.divCont.style.height=this.height,this.controls&&this.createControlBar()},FramePlayer.prototype.render=function(e,t){var n,i,a=Date.now(),s=1e3/t.rate,r=-1,o=document.createElement("img");t.canvas=document.createElement("canvas"),t.context=t.canvas.getContext("2d"),t.divCont.appendChild(t.canvas);var l=function(){n=Date.now(),i=n-a,i>s&&(a=n-i%s,t.paused||(r++,r>=e.frames.length&&(r=0),o.src=e.frames[r],t.context.drawImage(o,0,0,t.canvas.width,t.canvas.height))),window.requestAnimationFrame(l)};window.requestAnimationFrame(l)},FramePlayer.prototype.createControlBar=function(){var e=this,t=document.createElement("div");t.setAttribute("class","fp-ctrl"),t.style.width=this.width;var n=document.createElement("button");n.setAttribute("id","pause-"+e.elem),n.setAttribute("class","fp-btn"),n.innerHTML="Pause",n.addEventListener("click",function(){e.pause()},!1),t.appendChild(n);var i=document.createElement("button");i.setAttribute("id","play-"+e.elem),i.setAttribute("class","fp-btn"),i.innerHTML="Play",i.addEventListener("click",function(){e.resume()},!1),t.appendChild(i),e.paused?n.style.display="none":i.style.display="none";for(var a=document.createElement("select"),s=["normal","grayscale","sepia","invert"],r=0,o=s.length;o>r;r++){var l=document.createElement("option");l.setAttribute("value",s[r]),l.innerHTML=s[r],a.appendChild(l)}a.setAttribute("id","filter-"+e.elem),a.setAttribute("class","fp-select"),a.addEventListener("change",function(){e.setFilter(this.value)},!1),t.appendChild(a),this.divCont.appendChild(t)},FramePlayer.prototype.play=function(){this.getFile(this.jsonVideoSrc,this.render)},FramePlayer.prototype.resume=function(){var e=document.getElementById("play-"+this.elem),t=document.getElementById("pause-"+this.elem);e.style.display="none",t.style.display="block",this.paused=!1},FramePlayer.prototype.pause=function(){var e=document.getElementById("play-"+this.elem),t=document.getElementById("pause-"+this.elem);e.style.display="block",t.style.display="none",this.paused=!0},FramePlayer.prototype.setFilter=function(e){var t=document.querySelector("#"+this.elem+" canvas");switch(e){case"normal":t.setAttribute("class","");break;case"grayscale":t.setAttribute("class","fp-grayscale");break;case"sepia":t.setAttribute("class","fp-sepia");break;case"invert":t.setAttribute("class","fp-invert")}},FramePlayer.prototype.getFile=function(e,t){var n=new XMLHttpRequest,i=this,a=document.createElement("p");if(!n)throw"Error loading file.";n.open("GET",e,!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(null),n.onprogress=function(){a.innerHTML="Loading...",a.setAttribute("class","fp-loading"),i.divCont.appendChild(a)},void 0!==typeof n.onload?n.onload=function(){i.divCont.removeChild(a),t(JSON.parse(this.responseText),i),n=null}:n.onreadystatechange=function(){4===n.readyState&&(i.divCont.removeChild(a),t(JSON.parse(this.responseText),i),n=null)}},FramePlayer.prototype.initializeRequestAnimationFrame=function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),a=window.setTimeout(function(){t(n+i)},i);return e=n+i,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})};